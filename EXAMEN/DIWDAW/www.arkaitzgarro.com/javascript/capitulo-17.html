<!doctype html>
<html lang="es">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="author" content="Arkaitz Garro" />
    <meta name="date" content="08/01/2014"/>
    <meta name="generator" content="easybook 5.0-DEV"/>

    <title>Otras utilidades | JavaScript</title>

    <link rel="stylesheet" href="css/easybook.css" />

    <link rel="stylesheet" href="css/styles.css" />
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-39705204-1', 'arkaitzgarro.com');
      ga('send', 'pageview');

    </script>
</head>

<body class="item chapter">
<div class="container">
<div class="menu">
    <div class="row">
        <h1 class="span9"><a href="index.html">JavaScript</a></h1>
        <p class="span3">
                        <a href="capitulo-16.html"><span>&larr;</span> Anterior</a>
            
                        <a href="capitulo-18.html">Siguiente <span>&rarr;</span></a>
                    </p>
    </div>
</div>

<div class="row">
    <div class="span9">
        <h1 id="otras-utilidades"><span>Capítulo 17</span> Otras utilidades</h1>
        <h2 id="mejorar-el-rendimiento-de-las-aplicaciones-complejas">17.1 Mejorar el rendimiento de las aplicaciones complejas</h2>

<p>Cuando se desarrollan aplicaciones complejas, es habitual encontrarse con decenas de archivos JavaScript de miles de líneas de código. Estructurar las aplicaciones de esta forma es correcto y facilita el desarrollo de la aplicación, pero penaliza en exceso el rendimiento de la aplicación.</p>

<p>La primera recomendación para mejorar el rendimiento de la aplicación consiste en unir en un único archivo JavaScript el contenido de todos los diferentes archivos JavaScript. En Windows, se puede crear un pequeño programa ejecutable que copia el contenido de varios archivos JavaScript en uno solo:</p>

<div class="code bash">
<pre class="bash"><span class="kw2">more</span> archivo1.js <span class="sy0">&gt;</span> archivoUnico.js
<span class="kw2">more</span> archivo2.js <span class="sy0">&gt;&gt;</span> archivoUnico.js
<span class="kw2">more</span> archivo3.js <span class="sy0">&gt;&gt;</span> archivoUnico.js
...</pre>
</div>

<p>La primera instrucción tiene un solo símbolo <code>&gt;</code> para borrar el contenido del <code>archivoUnico.js</code> cada vez que se ejecuta el comando. El resto de instrucciones tienen un símbolo <code>&gt;&gt;</code> para añadir el contenido de los demás archivos al final del <code>archivoUnico.js</code></p>

<p>En sistemas operativos de tipo Linux es todavía más sencillo unir varios archivos en uno solo:</p>

<div class="code bash">
<pre class="bash"><span class="kw2">cat</span> archivo1.js archivo2.js archivo3.js <span class="sy0">&gt;</span> archivoUnico.js</pre>
</div>

<p>La única consideración que se debe tener en cuenta con este método es el de las dependencias entre archivos. Si por ejemplo el <code>archivo1.js</code> contiene funciones que dependen de otras funciones definidas en el <code>archivo3.js</code>, los archivos deberían unirse en este otro orden:</p>

<div class="code bash">
<pre class="bash"><span class="kw2">cat</span> archivo3.js archivo1.js archivo2.js <span class="sy0">&gt;</span> archivoUnico.js</pre>
</div>

<p>Otra recomendación muy útil para mejorar el rendimiento de la aplicación es la de comprimir el código de JavaScript. Este tipo de herramientas compresoras de código no modifican el comportamiento de la aplicación, pero pueden reducir mucho su tamaño.</p>

<p>El proceso de compresión consiste en eliminar todos los espacios en blanco sobrantes, eliminar todos los comentarios del código y convertir toda la aplicación en una única línea de código JavaScript muy larga. Algunos compresores van más allá y sustituyen el nombre de las variables y funciones por nombres más cortos.</p>

<p><a href="http://closure-compiler.appspot.com/home">Closure Compiler</a> es una de las herramientas proporcionadas por Google y que permite <em>compilar</em> nuestro código JavaScript, realizando un análisis del mismo, eliminando código innecesario, re-escribiéndolo y minimizando el código resultante. Además, comprueba nuestro código en busca de errores de sintaxis o mejoras que podamos aplicar.</p>

<h2 id="ofuscar-el-codigo-javascript">17.2 Ofuscar el código JavaScript</h2>

<p>El código de las aplicaciones JavaScript, al igual que el resto de contenidos de las páginas web, está disponible para ser accedido y visualizado por cualquier usuario. Con la aparición de las aplicaciones basadas en AJAX, muchas empresas han desarrollado complejas aplicaciones cuyo código fuente está a disposición de cualquier usuario.</p>

<p>Aunque se trata de un problema casi imposible de solucionar, existen técnicas que minimizan el problema de que se pueda acceder libremente al código fuente de la aplicación. La principal técnica es la de ofuscar el código fuente de la aplicación.</p>

<p>Los <em>ofuscadores</em> utilizan diversos mecanismos para hacer casi imposible de entender el código fuente de una aplicación. Manteniendo el comportamiento de la aplicación, consiguen ensuciar y dificultar tanto el código que no es mayor problema que alguien pueda acceder a ese código.</p>

<p>La herramienta Closure Compiler, también ofrece la posibilidad de ofuscar nuestro código JavaScript. Este es el código original antes de ofuscarlo:</p>

<div class="code javascript">
<pre class="javascript"><span class="co1">//------------------------------------------------------</span>
<span class="co1">// Calculate salary for each employee in &quot;aEmployees&quot;.</span>
<span class="co1">// &quot;aEmployees&quot; is array of &quot;Employee&quot; objects.</span>
<span class="co1">//------------------------------------------------------</span>
<span class="kw1">function</span> CalculateSalary<span class="br0">&#40;</span>aEmployees<span class="br0">&#41;</span>
<span class="br0">&#123;</span>
   <span class="kw1">var</span> nEmpIndex <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
   while <span class="br0">&#40;</span>nEmpIndex <span class="sy0">&lt;</span> aEmployees.<span class="me1">length</span><span class="br0">&#41;</span>
   <span class="br0">&#123;</span>
      <span class="kw1">var</span> oEmployee <span class="sy0">=</span> aEmployees<span class="br0">&#91;</span>nEmpIndex<span class="br0">&#93;</span><span class="sy0">;</span>
      oEmployee.<span class="me1">fSalary</span> <span class="sy0">=</span> CalculateBaseSalary<span class="br0">&#40;</span>oEmployee.<span class="me1">nType</span><span class="sy0">,</span>
                                              oEmployee.<span class="me1">nWorkingHours</span><span class="br0">&#41;</span><span class="sy0">;</span>
      <span class="kw1">if</span> <span class="br0">&#40;</span>oEmployee.<span class="me1">bBonusAllowed</span> <span class="sy0">==</span> <span class="kw2">true</span><span class="br0">&#41;</span>
      <span class="br0">&#123;</span>
         oEmployee.<span class="me1">fBonus</span> <span class="sy0">=</span> CalculateBonusSalary<span class="br0">&#40;</span>oEmployee.<span class="me1">nType</span><span class="sy0">,</span>
                                                 oEmployee.<span class="me1">nWorkingHours</span><span class="sy0">,</span>
                                                 oEmployee.<span class="me1">fSalary</span><span class="br0">&#41;</span><span class="sy0">;</span>
      <span class="br0">&#125;</span>
      <span class="kw1">else</span>
      <span class="br0">&#123;</span>
         oEmployee.<span class="me1">fBonus</span> <span class="sy0">=</span> <span class="nu0">0</span><span class="sy0">;</span>
      <span class="br0">&#125;</span>
      oEmployee.<span class="me1">sSalaryColor</span> <span class="sy0">=</span> GetSalaryColor<span class="br0">&#40;</span>oEmployee.<span class="me1">fSalary</span> <span class="sy0">+</span>
                                              oEmployee.<span class="me1">fBonus</span><span class="br0">&#41;</span><span class="sy0">;</span>
      nEmpIndex<span class="sy0">++;</span>
   <span class="br0">&#125;</span>
<span class="br0">&#125;</span></pre>
</div>

<p>Después de pasar el código anterior por el ofuscador el resultado es:</p>

<div class="code javascript">
<pre class="javascript"><span class="kw1">function</span> c<span class="br0">&#40;</span>g<span class="br0">&#41;</span><span class="br0">&#123;</span><span class="kw1">var</span> m<span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span>while<span class="br0">&#40;</span>m<span class="sy0">&lt;</span>g.<span class="me1">length</span><span class="br0">&#41;</span><span class="br0">&#123;</span><span class="kw1">var</span> r<span class="sy0">=</span>g<span class="br0">&#91;</span>m<span class="br0">&#93;</span><span class="sy0">;</span>r.<span class="me1">l</span><span class="sy0">=</span>d<span class="br0">&#40;</span>r.<span class="me1">n</span><span class="sy0">,</span>r.<span class="me1">o</span><span class="br0">&#41;</span><span class="sy0">;</span><span class="kw1">if</span><span class="br0">&#40;</span>r.<span class="me1">j</span><span class="sy0">==</span><span class="kw2">true</span><span class="br0">&#41;</span><span class="br0">&#123;</span>r.<span class="me1">k</span><span class="sy0">=</span>e<span class="br0">&#40;</span>r.<span class="me1">n</span><span class="sy0">,</span>r.<span class="me1">o</span><span class="sy0">,</span>r.<span class="me1">l</span><span class="br0">&#41;</span><span class="sy0">;</span><span class="br0">&#125;</span><span class="kw1">else</span><span class="br0">&#123;</span>r.<span class="me1">k</span><span class="sy0">=</span><span class="nu0">0</span><span class="sy0">;</span><span class="br0">&#125;</span>r.<span class="me1">t</span><span class="sy0">=</span>f<span class="br0">&#40;</span>r.<span class="me1">l</span><span class="sy0">+</span>r.<span class="me1">k</span><span class="br0">&#41;</span><span class="sy0">;</span>m<span class="sy0">++;</span><span class="br0">&#125;</span><span class="br0">&#125;</span></pre>
</div>

<p>Al sustituir todos los nombres de las variables y de las funciones por nombres de una sola letra, es prácticamente imposible comprender el código del programa. En ocasiones, también se utilizan ofuscadores de este tipo con el propósito de reducir el tamaño del código fuente.</p>

<p>Además de aplicaciones comerciales específicamente diseñadas para ofuscar código JavaScript, también se pueden utilizar las herramientas que minimizan el tamaño de los scripts. Eliminando los comentarios y reduciendo el nombre de todas las variables, los programas que minimizan el tamaño de los scripts también consiguen ofuscar su código.</p>

<p>La aplicación <a href="http://dean.edwards.name/packer/">packer</a> es gratuita, se puede acceder via web y consigue una excelente compresión del código original. También se puede utilizar <a href="http://adrian3.googlepages.com/jsjuicer.html">jsjuicer</a>, que está disponible como aplicación descargable y también se puede utilizar <a href="http://gueschla.com/labs/jsjuicer/">vía web</a>.</p>

    </div>

    <div class="span3">
        <div class="item local_toc">
            <h3>Índice de contenidos</h3>

            <ul class="unstyled">
                                                <li class="level-1">
                        <span></span>
                        <a class="internal" href="capitulo-17.html#otras-utilidades">Otras utilidades</a>
                    </li>
                                    <li class="level-2">
                        <span>17.1</span>
                        <a class="internal" href="capitulo-17.html#mejorar-el-rendimiento-de-las-aplicaciones-complejas">Mejorar el rendimiento de las aplicaciones complejas</a>
                    </li>
                                    <li class="level-2">
                        <span>17.2</span>
                        <a class="internal" href="capitulo-17.html#ofuscar-el-codigo-javascript">Ofuscar el código JavaScript</a>
                    </li>
                                        </ul>
        </div>
    </div>
</div>
</div>
</body>
</html>